---
title: "Translation Group of a Binary Function"
author: "Manu"
date: "4 June 2018"
output:
  html_document:
    css: ../custom.css
    number_sections: true
    toc: true
---

```{r setup, include=FALSE}
library(DiagrammeR)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
```


## Observation Group

Let $\mathcal{B} = \{0, 1 \}$ and let $F = \{f: \mathbb{R} \rightarrow \mathcal{B}\}$.

The **observation group** is the group of operations that leave a beat unchanged to the observer. We model this group on a real human listener. In our case there is only one operation, and it is time shift of the beat by any increment. Any other operation, such as changing the timing, inverting the recording can be heard by a human listener. Similarly, inverting the instruments (here the 0 and the 1) is also noticeable to our ears, so it is not in the observation group.

The observation group is $\mathbb{R}$ and it acts on F via the following action 
$$\bullet: F \times \mathbb{R} \rightarrow F \\ r \bullet t (x) \mapsto r(x + t) $$

To the observer, recordings that differ only by a time shift are identical and cannot be distinguished. So the observer is only interested in classes of equivalence of recordings that are shift-equivalent. Such equivalence classes are called **beats**, they are precisely the action of the observation group on F.

For any beat B, we can associate a unique subgroup S of $\mathbb{R}$, such that $\forall r \in B, Stab(r) = S$. We can also associate $Q = \mathbb{R}/S$ to the beat B.

The problem with this approach is that both S and Q are cyclic. So this approach is only good enough to assign cyclic symmetries to beats. Those are very simple and boring symmetries and I want to find a way to associate more complex groups to beats. The very nice things about these group is that they have a very natural definition. In some sense these groups capture the notion that a beat repeating 2 times in 4 is the same as a beat repeating 4 times in 8 or 6 times in 12. It only captures basic repetition information: how much time the beat is repeated and so the group is very small and simple.

We are only interested in recordings r such that there exists a smallest $a > 0$, such that $\forall x \in \mathbb{R}, r(a+x) = r(x)$.

## Playing Group

The **playing group** is the group of operations that one can make on the recordings. There are many operations that one can do, such as shifting the recording, inverting the recording, inverting 0 and 1 (interchanging the instruments), changing the speed of the recording. There are many different playing groups according to what operations we allow.

Here we consider the playing group as all the shifting of the recording and inverting of the recording. We do not consider yet change of the recording speed or inverting the instruments. We note $\forall t \in \mathbb{R}, D_t: F \rightarrow F$, the shift operations.  Finally, we write $I: F \rightarrow F \\ r(x) \mapsto r(-x)$, for the inversion operation that inverts the recording around the origin.

**Inversion around c** where $c \in \mathbb{R}$. We check that $D_c \circ I \circ D_{-c} = D_{2c} \circ I$ is the inversion around c. 

>Indeed $[D_c \circ I \circ D_{-c}] (r) (x) = r(-x+2c)$ So that $[D_c \circ I \circ D_{-c}] (r) (c) = r(c)$, so the center of inversion is preserved, and $[D_c \circ I \circ D_{-c}] (r) (c+a) = r(-(c+a)+2c) = r(c - a)$, so that we can see that points are inversed around c.

**Definition of the Playing Group P** is generated by $<D_t, I>$. We also have $[I \circ D_t \circ I] (r) (x) = r(x-t) = D_{-t}$. Finally the playing group is $<D_t, I \mid ID_tI = D_{-t}> = D_{\mathbb{R}} \rtimes <I> = \mathcal{P}$.

For any beat B, we can associate $Stab(B) \in \mathcal{P}$, the subgroup of P that maps B to itself. 

**Definition** For any recording r, we write $\mathcal{P}(r)$ the subgroup of P that maps r to itself. In other words $\mathcal{P}(r)$ is the stabilizer of r in $\mathcal{P}$

**Conjugacy classes** The conjugacy classes are:

*   {Id}
*   $\forall t \in \mathbb{R}^{+*}, \{D_t, D_{-t}\}$ 
*   $\{D_{t} \circ I \ | \  \forall t \in \mathbb{R}\}$

### Normal Subgroups of Playing Group

**Normal Decomposition**

$$0 \lhd D_{\mathbb{R}} \lhd D_{\mathbb{R}} \rtimes <I>$$

The quotients are: $<D_{\mathbb{R}}>$, $<I>$

We can also write it as:
$$0 \lhd \mathbb{R} \lhd \mathbb{R} \rtimes C(2)$$

With quotients: $\mathbb{R}$, $C(2)$.

**Property** $P/D_{\mathbb{R}}$ is isomorph to $C(2)$

**Normal Subgroups of P Containing the Translations**: $D_{\mathbb{R}}$, $ID_{\mathbb{R}}$.

Which gives rise to the following lattice:
```{r normal-lattice, echo = FALSE}
grViz('
digraph boxes_and_circles {

  graph [overlap = true, fontsize = 10, rankdir = "BT"]

  node [shape = circle,
        fontname = Helvetica,
        fillcolor = cyan,
        style = filled]
  D; 
  
  node [width = 1.5]
  ID [width = 2, fontsize = 22] 
  D [width = 1.5]
  e [width = 1]
  e->D->ID
}
')
```

**Definition** Let r be a recording. We write $\mathcal{GT}(r)$ the group $D_{\mathbb{R}} \cap \mathcal{P}(r)$. We call it the **lattice subgroup** of r.

**Property** The lattice subgroup of r is normal in $\mathcal{P}(r)$

> Proof: Let $g \in \mathcal{P}(r), D_t \in \mathcal{GT}(r)$. We have $g^{-1}D_tg \in D_{\mathbb{R}}$ and $g^{-1}D_tg \in \mathcal{P}(r)$ so that $g^{-1}D_tg \in \mathcal{GT}(r)$

**Definition** If the lattice subgroup of a recording is $D_{\mathbb{R}}$ we say that the recording has **continuous steps**, if the lattice subgroup is of the form $D_{a\mathbb{Z}}$ for $a \in \mathbb{R}^+$ we say the recording has **discrete steps** of size a. If the lattice subgroup if trivial, we say that the recording is time anchored.

### Point Group

**Definition** The **point group** at $c \in \mathbb{R}$ of a recording r is $\{p \in <D_c \circ I \circ D_{-c}> \mid p \bullet r = r\}$. We call it $\mathcal{GL}_c(r)$

The point group at c is always a subgroup of $<D_c \circ I \circ D_{-c}>$ which has only 2 elements.

The goal of this part is to define the structure of the point groups of a recording r.
The further goal is to associate to any beat B a point group.

**Property** Let's assume that r has discrete steps of pace a and that its point groups at c and d $\in \mathbb{R}$ are both non trivial. Then $a \over 2$ divides $|c-d|$ and in particular $|c-d| \geq {a \over 2}$.

> To understand the reasoning let's assume that the pattern between c and d is 12345, we write is c12345d. We can see that from this pattern and the information that the point groups at c and d are not trivial we can reconstruct the whole recording.
>
c12345d --Ic-> 54321c12345d -Id-> 54321c12345d54321_12345 -Ic-> 54321_12345_54321c12345d54321_12345 -Id-> 
54321_12345_54321c12345d54321_12345_54321_12345
>
We observe the size of these:
>
1 --> 2 --> 4 --> 6 --> 8 --> ... 
>
Apart from the first step we can see that each step grows the sequence by 2 measures.
>
If we write 12345 as XY and 54321 as YX we can rewrite the sequence as:
>
cXYd --Ic-> YXcXYd -Id-> YXcXYdYX_XY -Ic-> YX_XY_YXcXYdYX_XY -Id-> 
YX_XY_YXcXYdYX_XY_YX_XY
>
It looks like this beat has a translation invariant pattern XYYX, that repeats every $2|c-d|$. Which would mean that a, the minimum repeating distance must divide $2|c-d|$. Finally $\exists k \in \mathbb{N}, |c-d| = k{a \over 2}$, in particular, $|c-d| \geq {a \over 2}$.

  **Property** Let's assume that a recording r has a non-trivial point group at c. Then the point group at $c + {a \over 2}\mathbb{Z}$ is also not trivial.
  
  > We want to show that $\forall x \in \mathbb{R}, n \in \mathbb{Z}, r(c+a/2 + x) = r(c + a/2 -x)$
  First let's assume $\exists k \in \mathbb{Z}, n = 2k$
  Then we have, from the symmetry at c and the translation invariance by a, 
  $$r(c+na/2 + x) = r(c + ka +x ) = r(c+x) = r(c-x) = r(c +2ka -x) = r(c+na/2 - x)$$
  Now let's assume $\exists k \in \mathbb{Z}, n = 2k + 1$
  $$r(c+na/2 + x) = r(c + (2k+1)a/2 +x ) = r(c+ ka + a/2 + x) = r(c + a/2 + x) \\= r(c-x -a/2) = r(c +a/2 -x) = r(c+ 2ka/2 + a/2 - x) = r(c + na/2 -x)$$

  **Property** If a recording r has a non-trivial point group at c. Then $\forall t, D_t \bullet r$ has a non-trivial point group at c-t.
  
  >We want to show that $\forall x \in \mathbb{R}, D_tr(c-t + x) = D_tr(c-t-x)$. Said differently, we want to show that
  Indeed we have $$D_t(c-t + x) = r(t + c-t + x) = r(c+x) = r(c-x) = r(t + c - t - x) = D_tr(c-t-x)$$

  **Conclusion** The point group is a beat invariant. For each beat we can associate a subset of C(2), its point group.
  
  
  **Property** Let r be a recording with a non-trivial point group at c, then we have $\mathcal{P}(r) = \mathcal{GT}(r) \rtimes \mathcal{GL}_c(r)$ ???

Since

1. $\mathcal{GT}(r) \lhd \mathcal{P}(r)$
2. $\mathcal{GT}(r) \cap \mathcal{GL}_{c}(r) = \varnothing$

We have $\mathcal{GT}(r) \rtimes \mathcal{GL}_{c}(r) \subset \mathcal{P}(r)$.
  
## Examples

### Constant Recording

Constant recording $\forall x \in \mathbb{R}, 1_\mathbb{R}(x) = 1$.

The translation group is $D_{\mathbb{R}}$, the point group is $C(2)$.

We have $\mathcal{P}(1_\mathbb{R}) = \mathcal{P}$, its playing group is the full playing group.


### Alternating Recording

The alternated recording $\forall x \in (0, 1), al(x) = 1$ and $al(0) = 1/2$ and the following functional equation $\forall y \in \mathbb{R}, al(y+1) = 1 - al(y)$. 

**Property** We also have $\forall y \in \mathbb{R}, al(y-1) = 1 - al(y)$

>Indeed $al(y) = al(y-1+1) = 1 - al(y-1)$ so that $al(y-1) = 1 - al(y)$

**Property** Let's note that $\forall y \in \mathbb{Z}, al(y) = {1 \over 2}$

**Property** $\forall y,  al(-y) = 1 - al(y)$.

>In order to prove this we note that this is true for for $y \in [-1, 1]$.
Let $n \in \mathbb{N}$ let's assume it is true for $y \in [-n, n]$. Let $y \in [n; n+1]$.
We have $al(-y) = al(-(y-1+1)) = al(-(y-1)-1) = 1 - al(-(y-1)) = 1 - (1 - al(y-1)) = al(y-1) = 1-al(y)$
Now let's assume $y \in [-n-1,-n]$. $al(-y) = al(-(y+1-1)) = al(-(y+1) + 1) = 1 - al(-(y+1)) = al(y)$
So that by recurrence we have proved the property on $\mathbb{R}$

**Property** Its lattice subgroup is $D_{2 \mathbb{Z}}$

>Proof: al(y+2) = 1-al(y+1) = 1-(1-al(y)) = al(y).
>
So that $D_{2 \mathbb{Z}} \subset \mathcal{GT}(al)$
>
*Absurd Hypothesis* $D_{2 \mathbb{Z}} \neq \mathcal{GT}(al)$
Then there must exists a $t \in \mathbb{R} - D_{2 \mathbb{Z}}$ such that $D_t(al) = al$. Furthermore we can choose this t in $]0; 2[$.
Let's suppose t lies in $]0; 1[$, then $al(1- {t \over 2}) = 1$ we also have 
$$al(1- {t \over 2}+t) = al(t+ {t \over 2}) = 0$$ 
so that $D_t(al) \neq al$ and that means t must lie in $[1;2[$. 
>
We note that: 
$$1 < t < 2 \\
-2 < -t < -1 \\
0 < 2 - t < 1 \\
0 < {2-t \over 2} < {1 \over 2} \\
0 < 1 - {t \over 2} < {1 \over 2}$$
>
So that $al(1 - {t \over 2}) = 1$
>
$$0 < 1 - {t \over 2} \implies \\
t < 1 - {t \over 2} + t \implies \\
1 < 1 + {t\over 2} < 2$$
>
So that $al(1 - {t \over 2}+t) = 0$ and $D_t(al) \neq al$ and we have a contradiction.
>
Finally: $D_{2 \mathbb{Z}} = \mathcal{GT}(al)$

**Property** Its point group at 0.5 is $<D_{-0.5} \circ I \circ D_{0.5}>$ or $<D_{-1} \circ I>$

> Proof: $$\forall y \in \mathbb{R}, D_{-0.5} \circ^{\star} I \circ^\star D_{o.5} (al) (y) = al(-y+1) = \\
1 - al(-y) = al(y)$$

**Property** Its point group lattice is $0.5 + \mathbb{Z}$.

**Property** Structure of the playing group: 
$$\mathcal{P}(al) = \mathcal{GT}(al) \rtimes \mathcal{GL}_{0.5}(al) \sim \mathbb{Z} \rtimes C(2)$$

>Since
>
1. $\mathcal{GT}(al) \lhd \mathcal{P}(al)$
2. $\mathcal{GT}(al) \cap \mathcal{GL}_{0.5}(al) = \varnothing$
>
We have $\mathcal{GT}(al) \rtimes \mathcal{GL}_{0.5}(al) \subset \mathcal{P}(al)$. Now let's prove the opposite inclusion.
>
Let $F \in \mathcal{P}$ be a playing operator that leaves al fixed: $F(al) = al$.
Since $\mathcal{P} = D_{\mathbb{R}} \rtimes <I>$ with $D_{\mathbb{R}}$ being a normal subgroup of order 2, we know that there exists a unique $t \in \mathbb{R}$ such that F can be written uniquely as $F = D_t \circ I$ or $F = D_t$.
>
If $F = D_t$ then clearly $F \in D_{\mathbb{R}} \cap \mathcal{P}(al)$ so that $F \in \mathcal{GT}(al) \subset \mathcal{GT}(al) \rtimes \mathcal{GL}(al)$.
>
Now let's assume $F = D_t \circ I$
We write 
$$G = F \circ D_{-0.5} \circ I \circ D_{0.5} = D_t \circ I \circ D_{-0.5} \circ I \circ D_{0.5}=\\
D_t \circ D_{0.5} \circ D_{0.5}= D_{t+1}$$
>
Since $G \in \mathcal{P}(al)$, we must have $D_{t+1} \in D_{2\mathbb{Z}}$ or $2 \ | \ t+1$. So we can write $t+1 = 2k$ or $t = 2k-1$. So that F is written $F = D_{2k-1} \circ I = D_{2k} \circ (D_{-1} \circ I) \in \mathcal{GT}(al) \rtimes \mathcal{GL}_{0.5}(al)$
>
So $\mathcal{P}(al) \subset \mathcal{GT}(al) \rtimes \mathcal{GL}_{0.5}(al)$ and we have shown the result.

```{r echo = FALSE}
data = data.frame(x = c(-3, -2, -1, 0, 1, 2, 3, 4), y = c(0, 1, 0, 1, 0, 1, 0, 0))
ggplot(data, aes(x = x, y=y)) + geom_step() + labs(title = 'Alternating Beat Graph')
```

### Unsteady Alternating

The unsteady alternating recording, noted ul, is defined by the following relations:
$$\forall x \in (0, 1), \mathrm{ul}(x) = 1\\
\forall x \in (1, 3), \mathrm{ul}(x) = 0\\
ul(0) = ul(1) = ul(2) = {1\over2}\\
\forall x \in \mathbb{R}, ul(x+4) = ul(x)$$

```{r echo = FALSE}
data = data.frame(x = c(-5, -3, -2, 0, 1, 3, 4, 6), y = c(0, 1, 0, 1, 0, 1, 0, 0))
ggplot(data, aes(x = x, y=y)) + geom_step()
```

**Property** $\forall x \in \mathbb{Z}, \mathrm{ul}(x) = {1 \over 2}$

**Property** The lattice group $\mathcal{GT}(\mathrm{ul})$ is $4\mathbb{Z}$.

**Property** The point group $\mathcal{GL}(\mathrm{ul})$ is trivial.

### Mirror Symmetry

The mirror symmetry recording, noted ms, is defined by the following relations:
$$\forall x \in (-1, 1), \mathrm{ms}(x) = 0\\
\forall x \in \mathbb{R} \backslash (-1, 1), \mathrm{ms}(x) = 1$$
```{r echo = FALSE}
data = data.frame(x = c(-10, -1, 0, 1, 4, 10), y = c(1,  0, 0, 1, 1, 1))
ggplot(data, aes(x = x, y=y)) + geom_step()
```

**Property** The point group at 0 is C(2). It follows that $\mathcal{GL}(\mathrm{ms}) \sim C(2)$

**Property** The lattice group of ms is trivial.

## Discrete case

$F_n = \{f: C(n) \rightarrow \mathcal{B}\}, \forall n \in \mathbb{N}$

The observation group of $F_n$ is C(n), and C(n) acts on $F_n$ via the following coaction 
$\bullet: F_n \times C(n) \rightarrow F_n \\ r \bullet g (i) \mapsto r(g + i)$

This is indeed a coaction because $r \bullet g \bullet h (i)= r(h + g + i) = r \bullet (g+h) (i)$

## Classifying the beats of F_n

Let r be a recording of F_n


